import{d as m,Y as N,r as b,c as w,w as j,o as C,e,F as P,au as x,R as c,H as k,A as D,aY as E,O as F,aZ as B,z as R,B as u,a_ as S,a$ as A,h as M,f as o,b0 as z,a1 as T,M as U,b1 as q,ah as I,b2 as V,W as _,b3 as L,D as p,C as O,v as H,Z as K}from"./index-_yP02hNF.js";import{N as Y,a as Z}from"./ListItem-DkFgQhaz.js";function G(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!H(s)}const Q=m({setup(){const{data:s,pager:n,sortProps:W,fetchDataFn:f,loading:g}=N((a,t)=>async(h=d.query.page||1,y=30)=>{const i=await c.api.projects.get({params:{page:h,size:y}});a.value=i.data,t.value=i.pagination}),r=b(new Set),v=w(),d=K(),l=f;return j(()=>d.query.page,async a=>{await l(a)}),C(async()=>{await l()}),()=>e(O,null,{actions:()=>e(P,null,[e(x,{checkedRowKeys:r,onDelete:async()=>{await Promise.all(Array.from(r.values()).map(a=>c.api.projects(a).delete())),r.clear(),l()}},null),e(k,{to:"/projects/edit",icon:e(D,null,null)},null)]),default:()=>e(E,{show:g.value},{default:()=>[e(Y,{bordered:!1,class:"min-h-[300px] bg-transparent"},{footer(){return e("div",{class:"flex justify-end"},[e(F,{itemCount:n.value.total,pageCount:n.value.totalPage,page:n.value.currentPage,pageSize:n.value.size,onUpdatePage:a=>{l(a)}},null)])},default(){return s.value.map(a=>e(Z,{key:a.id},{prefix(){return e(B,{class:"mt-4",checked:r.has(a.id),onUpdateChecked:t=>{t?r.add(a.id):r.delete(a.id)}},null)},default(){return e(R,{description:a.description},{header(){return e("div",null,[e(u,S({ghost:!0,type:"primary",quaternary:!0,class:"!font-medium"},a.projectUrl?{tag:"a",href:a.projectUrl,target:"_blank"}:{}),{default:()=>[a.name]})])},footer(){return e(A,null,{default:()=>[e(M,{class:"pl-[3.6rem] text-sm text-[var(--clear-color-pressed)]"},{default:()=>[e("span",null,[o("创建于 "),z(a.created)]),a.modified&&e("span",null,[o("更新于")," ",e(T,{time:a.modified},null)])]})]})},"header-extra":function(){return e(U,null,{default:()=>[e(u,{onClick:()=>{q.push({name:I.EditProject,query:{id:a.id}})}},{default:()=>[o("编辑")]}),e(V,{class:"!p-0",options:[{value:"del",label:"",render(){return e(u,{type:"error",bordered:!1,onClick:async()=>{await c.api.projects(a.id).delete(),v.success("删除成功"),await l(n.value.currentPage)}},{default:()=>[o("删除")]})}}]},{default:()=>[e(u,{class:"!px-2"},{default:()=>[e(_,null,{default:()=>[e(L,null,null)]})]})]})]})},avatar(){let t;return a.avatar?e(p,{class:"align-center",circle:!0,src:a.avatar,size:"large"},null):e(p,{circle:!0,size:"large",class:"align-center"},G(t=a.name[0].toUpperCase())?t:{default:()=>[t]})}})}}))}})]})})}});export{Q as default};
